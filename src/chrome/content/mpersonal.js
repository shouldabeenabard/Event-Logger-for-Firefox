// This is our javascript, which will pop up our message// in an alert box.if ("undefined" == typeof(JSNamespace)) {  var JSNamespace = {};};JSNamespace.MPersonal = {  loadCred: function(){		Components.utils.import("resource://eventlogger/mpersonalCore.js");		this.commonCred = mPersonalCred;  },  askCred: function(){  	this.loadCred();			//the other alternative is to use modules		var prefs = Components.classes["@mozilla.org/preferences-service;1"]         .getService(Components.interfaces.nsIPrefService);         	if(prefs.getIntPref("extensions.mpersonal.enabled") != 1)    {    	this.commonCred.isKnown = true;		this.commonCred.user_id1 = "anon";		this.commonCred.user_id2 = "anon";        this.commonCred.user_site = "anon";        return;    }		if (this.commonCred.isKnown)    {        return;             //Information has already been collected    }    else	{	  	var ww = Components.classes["@mozilla.org/embedcomp/window-watcher;1"]						.getService(Components.interfaces.nsIWindowWatcher);		var otherprompt = ww.getWindowByName("mpersonalprompt",null);		if (otherprompt)					//If prompt open, puts it into focus		{			window.close();			otherprompt.focus();			return;		}			var params = {out:null, killparent:null};	    window.openDialog("chrome://eventlogger/content/prompt.xul", "mpersonalprompt",		"dialog,chrome,modal,centerscreen,resizable,width=400,height=400", params).focus();	}	if (params.killparent)	{		this.killViolently();	}	else	{   		//use the module to share information across a session		this.commonCred.isKnown = true;		this.commonCred.user_id1 = params.out.user_id1;		this.commonCred.user_id2 = params.out.user_id2;        this.commonCred.user_site = params.out.user_site;	}  },        killViolently: function(){	//force quit	Components.classes["@mozilla.org/toolkit/app-startup;1"]			.getService(Components.interfaces.nsIAppStartup)			.quit(Components.interfaces.nsIAppStartup.eForceQuit);   }  };JSNamespace.MPersonal.askCred();